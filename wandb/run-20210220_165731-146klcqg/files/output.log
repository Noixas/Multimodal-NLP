20/02/2021 04:57:32 PM : INFO - Data path checked..

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Running training with the following parameters: 
20/02/2021 04:57:32 PM : INFO - Model save path checked..
20/02/2021 04:57:32 PM : INFO - config JSON path checked..
20/02/2021 04:57:32 PM : INFO - Tensorboard Visualization path checked..
20/02/2021 04:57:32 PM : INFO - Cleaning Visualization path of older tensorboard files...


data_path : ./dataset
model_path : ./model_checkpoints
vis_path : ./vis_checkpoints
model_save_name : meme.pt
no_model_checkpoints : False
remove_checkpoints : False
config : config/uniter-base.json
feature_path : ./dataset/own_features
pretrained_model_file : uniter-base.pt
max_txt_len : 60
max_bb : 100
min_bb : 10
num_bb : 36
optimizer : adam
loss_func : bce_logits
optimize_for : aucroc
scheduler : warmup_cosine
beta1 : 0.9
beta2 : 0.999
batch_size : 16
num_workers : 0
gradient_accumulation : 2
max_grad_norm : 5
pos_wt : 1
lr : 3e-06
warmup_steps : 500
weight_decay : 0.001
max_epoch : 30
lr_decay_step : 3
lr_decay_factor : 0.8
patience : 5.0
early_stop_thresh : 0.001
seed : 43
log_every : 2000
fc_dim : 64
dropout : 0.2
filter_text : False
device : cuda
n_classes : 1

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
filter text False
filter text False
filter text False
20/02/2021 04:57:38 PM : INFO - Using pretrained UNITER base model ./model_checkpoints/uniter-base.pt
20/02/2021 04:57:38 PM : INFO - Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "max_position_embeddings": 512,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "type_vocab_size": 2,
  "vocab_size": 28996
}



====================================================================================================
					 Training Network
====================================================================================================

Beginning training at:  2021-02-20 16:57:42.104716 


Epoch: 1/30,            
train_loss = 0.6461,  train_acc = 0.6452,  train_prec = 0.0338,  train_recall = 0.5075,  train_f1 = 0.0634,  train_aucroc = 0.5744,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 0.6802,  eval_acc = 0.5400,  eval_prec = 0.1377,  eval_recall = 0.6667,  eval_f1 = 0.2282,  eval_aucroc = 0.6588,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00000160
Elapsed Time:  00:02:35.0220/02/2021 05:00:17 PM : INFO - New High Score! Saving model...

20/02/2021 05:00:18 PM : INFO - current patience: 0

Epoch: 2/30,            
train_loss = 0.5870,  train_acc = 0.6999,  train_prec = 0.3736,  train_recall = 0.6309,  train_f1 = 0.4693,  train_aucroc = 0.7226,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 0.7080,  eval_acc = 0.6040,  eval_prec = 0.2713,  eval_recall = 0.7882,  eval_f1 = 0.4036,  eval_aucroc = 0.6999,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00000300
Elapsed Time:  00:05:13.2620/02/2021 05:02:55 PM : INFO - New High Score! Saving model...

20/02/2021 05:02:56 PM : INFO - current patience: 0

Epoch: 3/30,            
train_loss = 0.4789,  train_acc = 0.7860,  train_prec = 0.6327,  train_recall = 0.7290,  train_f1 = 0.6774,  train_aucroc = 0.8313,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 0.7640,  eval_acc = 0.6080,  eval_prec = 0.3198,  eval_recall = 0.7383,  eval_f1 = 0.4463,  eval_aucroc = 0.7025,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00000300
Elapsed Time:  00:07:50.71
20/02/2021 05:05:32 PM : INFO - New High Score! Saving model...
20/02/2021 05:05:34 PM : INFO - current patience: 0

Epoch: 4/30,            
train_loss = 0.4051,  train_acc = 0.8326,  train_prec = 0.7181,  train_recall = 0.7912,  train_f1 = 0.7529,  train_aucroc = 0.8810,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 0.7737,  eval_acc = 0.6160,  eval_prec = 0.3644,  eval_recall = 0.7200,  eval_f1 = 0.4839,  eval_aucroc = 0.7182,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00000299
Elapsed Time:  00:10:28.1520/02/2021 05:08:10 PM : INFO - New High Score! Saving model...

20/02/2021 05:08:11 PM : INFO - current patience: 0

Epoch: 5/30,            
train_loss = 0.3343,  train_acc = 0.8742,  train_prec = 0.7887,  train_recall = 0.8467,  train_f1 = 0.8167,  train_aucroc = 0.9182,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 0.8378,  eval_acc = 0.6280,  eval_prec = 0.3927,  eval_recall = 0.7293,  eval_f1 = 0.5105,  eval_aucroc = 0.7218,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00000298
Elapsed Time:  00:13:09.8420/02/2021 05:10:51 PM : INFO - New High Score! Saving model...

20/02/2021 05:10:53 PM : INFO - current patience: 0
20/02/2021 05:13:34 PM : INFO - current patience: 1

Epoch: 6/30,            
train_loss = 0.2773,  train_acc = 0.9032,  train_prec = 0.8417,  train_recall = 0.8805,  train_f1 = 0.8606,  train_aucroc = 0.9407,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 0.9035,  eval_acc = 0.6300,  eval_prec = 0.4453,  eval_recall = 0.6962,  eval_f1 = 0.5432,  eval_aucroc = 0.7088,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00000296
Elapsed Time:  00:15:52.52

Epoch: 7/30,            
train_loss = 0.2348,  train_acc = 0.9205,  train_prec = 0.8711,  train_recall = 0.9016,  train_f1 = 0.8861,  train_aucroc = 0.9551,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 0.9388,  eval_acc = 0.6440,  eval_prec = 0.5101,  eval_recall = 0.6885,  eval_f1 = 0.5860,  eval_aucroc = 0.7092,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00000294
Elapsed Time:  00:18:33.8820/02/2021 05:16:15 PM : INFO - current patience: 2

20/02/2021 05:18:52 PM : INFO - current patience: 3

Epoch: 8/30,            
train_loss = 0.1950,  train_acc = 0.9362,  train_prec = 0.8907,  train_recall = 0.9269,  train_f1 = 0.9084,  train_aucroc = 0.9673,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 1.0041,  eval_acc = 0.6460,  eval_prec = 0.5101,  eval_recall = 0.6923,  eval_f1 = 0.5874,  eval_aucroc = 0.7053,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00000292
Elapsed Time:  00:21:10.25

Epoch: 9/30,            
train_loss = 0.1612,  train_acc = 0.9508,  train_prec = 0.9172,  train_recall = 0.9428,  train_f1 = 0.9298,  train_aucroc = 0.9752,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 1.1186,  eval_acc = 0.6460,  eval_prec = 0.4696,  eval_recall = 0.7160,  eval_f1 = 0.5672,  eval_aucroc = 0.7055,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00000289
Elapsed Time:  00:23:45.48
20/02/2021 05:21:27 PM : INFO - current patience: 4

Epoch: 10/30,            
train_loss = 0.1371,  train_acc = 0.9601,  train_prec = 0.9314,  train_recall = 0.9552,  train_f1 = 0.9431,  train_aucroc = 0.9823,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 1.2128,  eval_acc = 0.6200,  eval_prec = 0.4615,  eval_recall = 0.6667,  eval_f1 = 0.5455,  eval_aucroc = 0.6999,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00000286
Elapsed Time:  00:26:22.87
20/02/2021 05:24:04 PM : INFO - current patience: 5
20/02/2021 05:24:04 PM : INFO - Training terminated early because the Validation aucroc did not improve for  5.0  epochs

----------------------------------------------------------------------------------------------------

--------------------------------------------------
Best Validation scores:
--------------------------------------------------

Val accuracy of best model = 62.800
Val AUC-ROC of best model = 72.180
Val precision of best model = 39.271
Val recall of best model = 72.932
Val f1 of best model = 51.053

--------------------------------------------------
		Evaluating on test set
--------------------------------------------------
20/02/2021 05:24:05 PM : INFO - Using UNITER model ./model_checkpoints/meme.pt
20/02/2021 05:24:06 PM : INFO - Exporting dev_seen predictions...
20/02/2021 05:24:09 PM : INFO - Finished export of dev_seen predictions
20/02/2021 05:24:09 PM : INFO - Optimal threshold on validation dataset: 0.5000 (accuracy=62.80%)
20/02/2021 05:24:09 PM : INFO - Export and testing on test_seen...
20/02/2021 05:24:14 PM : INFO - Finished export of test predictions
