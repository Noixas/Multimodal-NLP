23/02/2021 11:44:30 AM : INFO - Data path checked..

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Running training with the following parameters: 
23/02/2021 11:44:30 AM : INFO - Model save path checked..
23/02/2021 11:44:30 AM : INFO - config JSON path checked..
23/02/2021 11:44:30 AM : INFO - Tensorboard Visualization path checked..
23/02/2021 11:44:30 AM : INFO - Cleaning Visualization path of older tensorboard files...


data_path : ./dataset
model_path : ./model_checkpoints
vis_path : ./vis_checkpoints
model_save_name : meme.pt
no_model_checkpoints : False
remove_checkpoints : False
config : config/uniter-base.json
feature_path : ./dataset/own_features
pretrained_model_file : uniter-base.pt
max_txt_len : 60
max_bb : 100
min_bb : 10
num_bb : 36
optimizer : adam
loss_func : bce_logits
optimize_for : aucroc
scheduler : warmup_cosine
beta1 : 0.9
beta2 : 0.999
batch_size : 16
num_workers : 0
gradient_accumulation : 2
max_grad_norm : 5
pos_wt : 1.0
lr : 3e-05
warmup_steps : 500
weight_decay : 0.001
max_epoch : 30
lr_decay_step : 3
lr_decay_factor : 0.8
patience : 5.0
early_stop_thresh : 0.001
seed : 43
log_every : 2000
fc_dim : 64
dropout : 0.2
filter_text : False
no_normalize_img : True
train_filename : train.jsonl
upsample_multiplier : 0
note : 
race_gender_hidden_size : 8
device : cuda
n_classes : 1

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
filter text False
Loaded dataset contains  8500 samples
filter text False
Loaded dataset contains  500 samples
filter text False
Loaded dataset contains  1000 samples
23/02/2021 11:44:37 AM : INFO - Using pretrained UNITER base model ./model_checkpoints/uniter-base.pt
23/02/2021 11:44:37 AM : INFO - Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "max_position_embeddings": 512,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "type_vocab_size": 2,
  "vocab_size": 28996
}

Traceback (most recent call last):
  File "train_uniter.py", line 651, in <module>
    trainer = TrainerUniter(config)
  File "train_uniter.py", line 61, in __init__
    self.init_training_params()
  File "train_uniter.py", line 64, in init_training_params
    self.init_model()
  File "train_uniter.py", line 108, in init_model
    hidden_size=base_model.uniter.config.hidden_size + self.config.race_gender_hidden_size,
AttributeError: 'dict' object has no attribute 'race_gender_hidden_size'
