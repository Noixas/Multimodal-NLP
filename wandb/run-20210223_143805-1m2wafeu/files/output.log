23/02/2021 02:38:08 PM : INFO - Data path checked..
23/02/2021 02:38:08 PM : INFO - Model save path checked..
23/02/2021 02:38:08 PM : INFO - config JSON path checked..
23/02/2021 02:38:08 PM : INFO - Tensorboard Visualization path checked..
23/02/2021 02:38:08 PM : INFO - Cleaning Visualization path of older tensorboard files...


xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Running training with the following parameters: 

data_path : ./dataset
model_path : ./model_checkpoints
vis_path : ./vis_checkpoints
model_save_name : meme.pt
no_model_checkpoints : False
remove_checkpoints : False
config : config/uniter-base.json
feature_path : ./dataset/own_features
pretrained_model_file : uniter-base.pt
max_txt_len : 60
max_bb : 100
min_bb : 10
num_bb : 36
optimizer : adam
loss_func : bce_logits
optimize_for : aucroc
scheduler : warmup_cosine
beta1 : 0.9
beta2 : 0.999
batch_size : 16
num_workers : 0
gradient_accumulation : 2
max_grad_norm : 5
pos_wt : 1.0
lr : 3e-05
warmup_steps : 500
weight_decay : 0.001
max_epoch : 30
lr_decay_step : 3
lr_decay_factor : 0.8
patience : 10.0
early_stop_thresh : 0.001
seed : 43
log_every : 2000
fc_dim : 64
dropout : 0.2
filter_text : False
normalize_img : False
train_filename : train.jsonl
upsample_multiplier : 3
note : 
race_gender_hidden_size : 8
device : cuda
n_classes : 1

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
filter text False
Confounders upsampled by 3 times. 
 From 1903  samples to 5709
Upsample both parts of confounders, hateful and non hateful - option 2
Saved confounder samples to: 
./dataset/train_upsampled_confounders_3x_times.jsonl
Loaded dataset contains  14209 samples
filter text False
Loaded dataset contains  500 samples
filter text False
Loaded dataset contains  1000 samples
23/02/2021 02:38:18 PM : INFO - Using pretrained UNITER base model ./model_checkpoints/uniter-base.pt
23/02/2021 02:38:18 PM : INFO - Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "max_position_embeddings": 512,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "type_vocab_size": 2,
  "vocab_size": 28996
}



====================================================================================================
					 Training Network
====================================================================================================

Beginning training at:  2021-02-23 14:38:21.507246 

23/02/2021 02:42:49 PM : INFO - New High Score! Saving model...

Epoch: 1/30,            
train_loss = 0.6869,  train_acc = 0.5475,  train_prec = 0.2147,  train_recall = 0.5088,  train_f1 = 0.3020,  train_aucroc = 0.5382,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 0.6964,  eval_acc = 0.5060,  eval_prec = 0.0000,  eval_recall = nan,  eval_f1 = nan,  eval_aucroc = 0.5470,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002670
Elapsed Time:  00:04:27.81
23/02/2021 02:42:50 PM : INFO - current patience: 0
23/02/2021 02:47:10 PM : INFO - New High Score! Saving model...

Epoch: 2/30,            
train_loss = 0.6047,  train_acc = 0.6812,  train_prec = 0.5591,  train_recall = 0.6839,  train_f1 = 0.6153,  train_aucroc = 0.7296,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 0.7249,  eval_acc = 0.6140,  eval_prec = 0.4170,  eval_recall = 0.6776,  eval_f1 = 0.5163,  eval_aucroc = 0.6721,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002998
Elapsed Time:  00:08:49.05
23/02/2021 02:47:12 PM : INFO - current patience: 0

Epoch: 3/30,            
train_loss = 0.4484,  train_acc = 0.7998,  train_prec = 0.7714,  train_recall = 0.7856,  train_f1 = 0.7784,  train_aucroc = 0.8705,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 0.8674,  eval_acc = 0.5860,  eval_prec = 0.2794,  eval_recall = 0.7041,  eval_f1 = 0.4000,  eval_aucroc = 0.6846,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002992
Elapsed Time:  00:13:11.39
23/02/2021 02:51:32 PM : INFO - New High Score! Saving model...
23/02/2021 02:51:34 PM : INFO - current patience: 0

Epoch: 4/30,            
train_loss = 0.2997,  train_acc = 0.8789,  train_prec = 0.8648,  train_recall = 0.8691,  train_f1 = 0.8669,  train_aucroc = 0.9435,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 1.0199,  eval_acc = 0.6580,  eval_prec = 0.4696,  eval_recall = 0.7436,  eval_f1 = 0.5757,  eval_aucroc = 0.7131,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002982
Elapsed Time:  00:17:32.57
23/02/2021 02:55:54 PM : INFO - New High Score! Saving model...
23/02/2021 02:55:55 PM : INFO - current patience: 0
23/02/2021 03:00:08 PM : INFO - New High Score! Saving model...

Epoch: 5/30,            
train_loss = 0.1957,  train_acc = 0.9269,  train_prec = 0.9176,  train_recall = 0.9217,  train_f1 = 0.9196,  train_aucroc = 0.9750,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 0.9005,  eval_acc = 0.6840,  eval_prec = 0.6316,  eval_recall = 0.6996,  eval_f1 = 0.6638,  eval_aucroc = 0.7249,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002968
Elapsed Time:  00:21:47.31
23/02/2021 03:00:10 PM : INFO - current patience: 0

Epoch: 6/30,            
train_loss = 0.1356,  train_acc = 0.9535,  train_prec = 0.9501,  train_recall = 0.9479,  train_f1 = 0.9490,  train_aucroc = 0.9864,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 1.3338,  eval_acc = 0.6460,  eval_prec = 0.4372,  eval_recall = 0.7397,  eval_f1 = 0.5496,  eval_aucroc = 0.7125,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002949
Elapsed Time:  00:25:59.55
23/02/2021 03:04:21 PM : INFO - current patience: 1

Epoch: 7/30,            
train_loss = 0.0860,  train_acc = 0.9727,  train_prec = 0.9722,  train_recall = 0.9680,  train_f1 = 0.9701,  train_aucroc = 0.9936,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 1.2378,  eval_acc = 0.6700,  eval_prec = 0.5709,  eval_recall = 0.7050,  eval_f1 = 0.6309,  eval_aucroc = 0.7194,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002927
Elapsed Time:  00:30:18.8723/02/2021 03:08:40 PM : INFO - current patience: 2

23/02/2021 03:13:03 PM : INFO - New High Score! Saving model...

Epoch: 8/30,            
train_loss = 0.0718,  train_acc = 0.9770,  train_prec = 0.9745,  train_recall = 0.9750,  train_f1 = 0.9748,  train_aucroc = 0.9954,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 1.3137,  eval_acc = 0.6540,  eval_prec = 0.4130,  eval_recall = 0.7846,  eval_f1 = 0.5411,  eval_aucroc = 0.7250,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002900
Elapsed Time:  00:34:42.33
23/02/2021 03:13:05 PM : INFO - current patience: 3
23/02/2021 03:17:25 PM : INFO - current patience: 4

Epoch: 9/30,            
train_loss = 0.0669,  train_acc = 0.9796,  train_prec = 0.9756,  train_recall = 0.9795,  train_f1 = 0.9776,  train_aucroc = 0.9955,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 1.6181,  eval_acc = 0.6220,  eval_prec = 0.3360,  eval_recall = 0.7685,  eval_f1 = 0.4676,  eval_aucroc = 0.7162,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002869
Elapsed Time:  00:39:03.57
