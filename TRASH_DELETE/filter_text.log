
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Running training with the following parameters: 

data_path : ./dataset
model_path : ./model_checkpoints
vis_path : ./vis_checkpoints
model_save_name : meme.pt
no_model_checkpoints : False
remove_checkpoints : False
config : config/uniter-base.json
feature_path : ./dataset/own_features
pretrained_model_file : uniter-base.pt
max_txt_len : 60
max_bb : 100
min_bb : 10
num_bb : 36
optimizer : adam
loss_func : bce_logits
optimize_for : aucroc
scheduler : warmup_cosine
beta1 : 0.9
beta2 : 0.999
batch_size : 16
num_workers : 0
gradient_accumulation : 2
max_grad_norm : 5
pos_wt : 1
lr : 3e-05
warmup_steps : 500
weight_decay : 0.001
max_epoch : 30
lr_decay_step : 3
lr_decay_factor : 0.8
patience : 5.0
early_stop_thresh : 0.001
seed : 43
log_every : 2000
fc_dim : 64
dropout : 0.2
filter_text : True
device : cuda
n_classes : 1

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
filter text True
filter text True
filter text True


====================================================================================================
					 Training Network
====================================================================================================

Beginning training at:  2021-02-20 02:04:12.183346 


Epoch: 1/30,            
train_loss = 0.6465,  train_acc = 0.6460,  train_prec = 0.0222,  train_recall = 0.5403,  train_f1 = 0.0426,  train_aucroc = 0.5525,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 0.7241,  eval_acc = 0.5160,  eval_prec = 0.0891,  eval_recall = 0.5641,  eval_f1 = 0.1538,  eval_aucroc = 0.5077,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00001596
Elapsed Time:  00:02:33.37

Epoch: 2/30,            
train_loss = 0.6154,  train_acc = 0.6789,  train_prec = 0.2249,  train_recall = 0.6358,  train_f1 = 0.3323,  train_aucroc = 0.6451,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 0.7626,  eval_acc = 0.5660,  eval_prec = 0.2591,  eval_recall = 0.6531,  eval_f1 = 0.3710,  eval_aucroc = 0.6000,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00003000
Elapsed Time:  00:05:12.93

Epoch: 3/30,            
train_loss = 0.5259,  train_acc = 0.7506,  train_prec = 0.5442,  train_recall = 0.6883,  train_f1 = 0.6078,  train_aucroc = 0.7822,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 0.8691,  eval_acc = 0.5740,  eval_prec = 0.1984,  eval_recall = 0.7656,  eval_f1 = 0.3151,  eval_aucroc = 0.6586,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002997
Elapsed Time:  00:07:50.43

Epoch: 4/30,            
train_loss = 0.4798,  train_acc = 0.7788,  train_prec = 0.6178,  train_recall = 0.7198,  train_f1 = 0.6649,  train_aucroc = 0.8286,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 0.7300,  eval_acc = 0.6160,  eval_prec = 0.4534,  eval_recall = 0.6627,  eval_f1 = 0.5385,  eval_aucroc = 0.6637,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002990
Elapsed Time:  00:10:30.89

Epoch: 5/30,            
train_loss = 0.3917,  train_acc = 0.8233,  train_prec = 0.7334,  train_recall = 0.7606,  train_f1 = 0.7467,  train_aucroc = 0.8928,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 0.6880,  eval_acc = 0.6200,  eval_prec = 0.3765,  eval_recall = 0.7209,  eval_f1 = 0.4947,  eval_aucroc = 0.6986,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002979
Elapsed Time:  00:13:09.87

Epoch: 6/30,            
train_loss = 0.3177,  train_acc = 0.8660,  train_prec = 0.8076,  train_recall = 0.8138,  train_f1 = 0.8106,  train_aucroc = 0.9313,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 0.7789,  eval_acc = 0.6480,  eval_prec = 0.4939,  eval_recall = 0.7052,  eval_f1 = 0.5810,  eval_aucroc = 0.7275,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002963
Elapsed Time:  00:15:47.51

Epoch: 7/30,            
train_loss = 0.2531,  train_acc = 0.8929,  train_prec = 0.8463,  train_recall = 0.8514,  train_f1 = 0.8488,  train_aucroc = 0.9571,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 1.1771,  eval_acc = 0.6220,  eval_prec = 0.3158,  eval_recall = 0.7959,  eval_f1 = 0.4522,  eval_aucroc = 0.7047,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002943
Elapsed Time:  00:18:26.08

Epoch: 8/30,            
train_loss = 0.2007,  train_acc = 0.9191,  train_prec = 0.8854,  train_recall = 0.8866,  train_f1 = 0.8860,  train_aucroc = 0.9728,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 1.1395,  eval_acc = 0.6200,  eval_prec = 0.3158,  eval_recall = 0.7879,  eval_f1 = 0.4509,  eval_aucroc = 0.7117,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002919
Elapsed Time:  00:21:03.31

Epoch: 9/30,            
train_loss = 0.1485,  train_acc = 0.9435,  train_prec = 0.9278,  train_recall = 0.9145,  train_f1 = 0.9211,  train_aucroc = 0.9849,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 1.2761,  eval_acc = 0.6420,  eval_prec = 0.4453,  eval_recall = 0.7237,  eval_f1 = 0.5514,  eval_aucroc = 0.7112,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002890
Elapsed Time:  00:23:41.24

Epoch: 10/30,            
train_loss = 0.1265,  train_acc = 0.9522,  train_prec = 0.9351,  train_recall = 0.9308,  train_f1 = 0.9329,  train_aucroc = 0.9891,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 1.4398,  eval_acc = 0.6380,  eval_prec = 0.3968,  eval_recall = 0.7538,  eval_f1 = 0.5199,  eval_aucroc = 0.7170,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002858
Elapsed Time:  00:26:20.53

Epoch: 11/30,            
train_loss = 0.0964,  train_acc = 0.9656,  train_prec = 0.9579,  train_recall = 0.9460,  train_f1 = 0.9519,  train_aucroc = 0.9931,  train_opt_accuracy = -1.0000,  train_threshold = -1.0000            
eval_loss = 1.2881,  eval_acc = 0.6360,  eval_prec = 0.4453,  eval_recall = 0.7097,  eval_f1 = 0.5473,  eval_aucroc = 0.7229,  eval_opt_accuracy = -1.0000,  eval_threshold = -1.0000                
lr  =  0.00002821
Elapsed Time:  00:28:57.22

----------------------------------------------------------------------------------------------------

--------------------------------------------------
Best Validation scores:
--------------------------------------------------

Val accuracy of best model = 64.800
Val AUC-ROC of best model = 72.748
Val precision of best model = 49.393
Val recall of best model = 70.520
Val f1 of best model = 58.095

--------------------------------------------------
		Evaluating on test set
--------------------------------------------------
